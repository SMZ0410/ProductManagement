
@{
    ViewBag.Title = "GetRoleInfos";
}

<h2>角色信息</h2>

<input type="text" id="RoleName" placeholder="请输入角色名称" />
<input type="button" value="查询" id="BtnQuery" />

<table class="table">
    <thead>
        <tr>
            <td>编号</td>
            <td>角色名称</td>
            <td>功能权限</td>
            <td>关联用户数</td>
            <td>操作</td>
        </tr>
    </thead>
    <tbody id="tb">
    </tbody>
</table>

<script src="~/Scripts/jquery-3.3.1.min.js"></script>

<script>

    $().ready(function () {
        RoleQuery("");
    });
    function RoleQuery(rolename) {
        var obj = {
            RoleName: rolename
        };
        $.ajax({
            url: '/Role/GetRole',
            type: 'POST',
            dataType: 'json',
            data: obj,
            success: function (data) {
                var tr = "";
                $(data.RoleInfo).each(function () {
                    var st = "<tr>"
                        + "<td>" + this.RoleId + "</td>"
                        + "<td>" + this.RoleName + "</td>"
                        + "<td>" + this.privilegeName + "</td>"
                        + "<td>" + this.UserNum + "</td>"
                        + "<td><input type='button' value='编辑' /><a onclick='Del(" + this.RoleId + ")'>删除</a></td>"
                        + "</tr>";
                    tr += st;
                });
                $("#tb").html(tr);
            }
        });
    }
    $("#BtnQuery").click(function () {
        var rolename = $("#RoleName").val();
        RoleQuery(rolename);
    });



    function Del(RoleId) {
        var obj = {
            RoleAll : {
                RoleId:RoleId
            }
        }
        if (confirm("确定删除吗·qin~~")) {
            $.ajax({
                url: '/Role/DeleteRole',
                type: 'post',
                dataType: 'json',
                data: obj,
                success: function (data) {
                    if (data > 0) {
                        alert('删除成功');
                    }
                }
            })
        }
    }
</script>
